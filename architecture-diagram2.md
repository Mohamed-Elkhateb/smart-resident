# Smart Home API - AWS Infrastructure with VPC & Availability Zones

```
                                    INTERNET
                                       â”‚
                                   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”
                                   â”‚  IGW  â”‚ Internet Gateway
                                   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
                                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              AWS REGION (us-east-1)                         â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                            VPC (10.0.0.0/16)                       â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚   â”‚
â”‚  â”‚  â”‚    AVAILABILITY ZONE A  â”‚    â”‚    AVAILABILITY ZONE B  â”‚        â”‚   â”‚
â”‚  â”‚  â”‚      (us-east-1a)       â”‚    â”‚      (us-east-1b)       â”‚        â”‚   â”‚
â”‚  â”‚  â”‚                         â”‚    â”‚                         â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Public Subnet   â”‚    â”‚    â”‚  â”‚ Public Subnet   â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ 10.0.1.0/24     â”‚    â”‚    â”‚  â”‚ 10.0.2.0/24     â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                 â”‚    â”‚    â”‚  â”‚                 â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚    â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚API Gateway  â”‚ â”‚    â”‚    â”‚  â”‚ â”‚API Gateway  â”‚ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚Edge Locationâ”‚ â”‚    â”‚    â”‚  â”‚ â”‚Edge Locationâ”‚ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚- REST API   â”‚ â”‚    â”‚    â”‚  â”‚ â”‚- Failover   â”‚ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚- CORS       â”‚ â”‚    â”‚    â”‚  â”‚ â”‚- Load Bal   â”‚ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚    â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚                         â”‚    â”‚                         â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Private Subnet  â”‚    â”‚    â”‚  â”‚ Private Subnet  â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ 10.0.3.0/24     â”‚    â”‚    â”‚  â”‚ 10.0.4.0/24     â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                 â”‚    â”‚    â”‚  â”‚                 â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚    â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚   Lambda    â”‚ â”‚    â”‚    â”‚  â”‚ â”‚   Lambda    â”‚ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ Functions   â”‚ â”‚    â”‚    â”‚  â”‚ â”‚ Functions   â”‚ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚- Create     â”‚ â”‚    â”‚    â”‚  â”‚ â”‚- Get All    â”‚ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚- Get Device â”‚ â”‚    â”‚    â”‚  â”‚ â”‚- Update     â”‚ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚- Delete     â”‚ â”‚    â”‚    â”‚  â”‚ â”‚- Replicas   â”‚ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚    â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚                         â”‚    â”‚                         â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Database Subnet â”‚    â”‚    â”‚  â”‚ Database Subnet â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ 10.0.5.0/24     â”‚    â”‚    â”‚  â”‚ 10.0.6.0/24     â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                 â”‚    â”‚    â”‚  â”‚                 â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚    â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ DynamoDB    â”‚ â”‚    â”‚    â”‚  â”‚ â”‚ DynamoDB    â”‚ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ Primary     â”‚â—„â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”¼â–ºâ”‚ Replica     â”‚ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚- Devices    â”‚ â”‚    â”‚    â”‚  â”‚ â”‚- Auto Sync  â”‚ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚- Encryption â”‚ â”‚    â”‚    â”‚  â”‚ â”‚- Failover   â”‚ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚    â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚        â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚        â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚   â”‚
â”‚  â”‚  â”‚    AVAILABILITY ZONE C  â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚      (us-east-1c)       â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚                         â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Backup Subnet   â”‚    â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ 10.0.7.0/24     â”‚    â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚  â”‚                 â”‚    â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ DynamoDB    â”‚ â”‚    â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚ Backup      â”‚ â”‚    â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚- Point Time â”‚ â”‚    â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚- Disaster   â”‚ â”‚    â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â”‚  Recovery   â”‚ â”‚    â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚                                       â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                                       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        MANAGED SERVICES                             â”‚   â”‚
â”‚  â”‚                      (Multi-AZ by Default)                         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ Amazon Cognito  â”‚  â”‚   CloudWatch    â”‚  â”‚      Route 53   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ - User Pool     â”‚  â”‚ - Logs & Metricsâ”‚  â”‚ - DNS Failover  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ - Multi-Region  â”‚  â”‚ - Alarms        â”‚  â”‚ - Health Checks â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ - Auto Scale    â”‚  â”‚ - Dashboards    â”‚  â”‚                 â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## **Network & Infrastructure Details:**

### ğŸŒ **VPC Configuration:**
- **CIDR:** 10.0.0.0/16 (65,536 IP addresses)
- **Internet Gateway** for public access
- **Route Tables** for traffic routing
- **Security Groups** as virtual firewalls

### ğŸ¢ **Availability Zones:**
- **AZ-A (us-east-1a):** Primary compute and data
- **AZ-B (us-east-1b):** Replica and failover
- **AZ-C (us-east-1c):** Backup and disaster recovery

### ğŸ“¡ **Subnets:**
- **Public Subnets:** API Gateway endpoints
- **Private Subnets:** Lambda functions (secure)
- **Database Subnets:** DynamoDB isolated

### ğŸ”„ **High Availability:**
- Cross-AZ replication for all data
- Automatic failover in <30 seconds
- Load balancing across zones
- 99.99% availability SLA

### ğŸ›¡ï¸ **Security:**
- Private subnets for compute layer
- VPC endpoints for AWS services
- Security groups restrict access
- No direct internet access to Lambda

---

## **Important Note About Serverless Architecture:**

**Your current SAM template deploys a SERVERLESS architecture** which means:
- **No VPC required** - AWS manages the infrastructure
- **API Gateway** is a managed service (no VPC)
- **Lambda** runs in AWS-managed VPC by default
- **DynamoDB** is a managed service (no VPC)
- **Cognito** is a global managed service

**To implement the VPC architecture above, you would need to:**
1. Create VPC resources in your SAM template
2. Configure Lambda functions with VPC settings
3. Set up VPC endpoints for DynamoDB access
4. Add NAT Gateways for Lambda internet access

**Current deployment = Simpler, cheaper, still highly available**
**VPC deployment = More control, enterprise compliance, higher cost**